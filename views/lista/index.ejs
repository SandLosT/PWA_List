<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,interactive-widget=resizes-content" />
  <title>Make It List - Minhas Listas</title>
  <link rel="icon" type="image/x-icon" href="/images/favicon/favicon.ico">
  <link rel="manifest" href="/manifest.json" />
  <link rel="stylesheet" href="/styles/module/Botao.css" />
  <link rel="stylesheet" href="/styles/module/Checklist.css" />
  <link rel="stylesheet" href="/styles/module/Etiqueta.css" />
  <%- include('../partials/_styles') %>
    <style>
      .swal2-cancel {
        color: black;
      }
      .dropdown > button {
        color: white;
      }
    </style>
</head>

<body>

  <%- include('../partials/_header') %>

    <main class="position-relative">
      <article class="d-flex flex-column px-3">
        <section class="d-flex flex-column flex-fill">
          <div>
            <div class="d-flex align-items-center mt-3 mb-3">
              <h3 class="m-0">Minhas listas</h3>
            </div>
            <hr />
          </div>
          <div class="flex-fill">

          <% if (listas.length> 0) { %>
          <%# listas %>
          <div class="container p-0" style="max-width: 500px;padding-bottom:80px !important;">
            <% for(var lista of listas) { %>
            <div class="etiqueta etiqueta--lista">
              <a class="etiqueta__conteudo d-flex flex-wrap justify-content-between" style="color:white !important" href="/lista/<%= lista.id %>">
                <div class="etiqueta__titulo">
                  <%= lista.titulo %>
                </div>
                <div class="etiqueta__descricao">
                  <%= lista.itens.length %>/99 itens
                </div>
              </a>
              <%- include('./_contextMenuLista', { id: lista.id }) %>
            </div>
            <% } %>
          </div>
          <% } else { %>
          <div class="h-100 d-flex flex-column align-items-center justify-content-center">
            <img class="mb-3" style="width:100px" src="/images/icons/list-512x512.png" alt="Ícone de lista" />
            <p class="text-center fw-bold mb-0">Você ainda não criou nenhuma lista!</p>
            <p class="text-center">Clique no botão <span style="color:#7F07F0">Adicionar</span> no canto inferior direito para criar uma nova lista!</p>
          </div>
          <% } %>
        </div>
      </section>
    </article>
    <button id="botaoAdicionar" type="button" class="btn btn-primary botao--absoluto-inferior" style="border-radius:100%;" data-bs-toggle="modal" data-bs-target="#modalCriarLista">
      <i class="fa-solid fa-plus"></i>
    </button>
  </main>

  <%- include('./_modalCriarLista') %>
  <%- include('./_modalRenomearLista') %>

  <%- include('../partials/_scripts') %>

  <script src="/scripts/CRUD/listaCRUD.js"></script>

  <script>
    function abrirModalRenomearLista(id) {
      $.get("/lista/pesquisarPorId/" + id, function (lista) {
        if (lista != null) {
          $('#formRenomearLista').find('input[name="id"]').val(lista.id)
          $('#formRenomearLista').find('input[name="titulo"]').val(lista.titulo)
          $('#modalRenomearLista').modal('show')
        } else {
          Swal.fire({
            title: "Erro!",
            text: "Não foi possível carregar os dados da lista!",
            icon: "error"
          }).then(function () {
            window.location.reload()
          })
        }
      })
    }
  </script>

</body>

</html>